<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å•è¯è¿·å®«æ¸¸æˆ - è¶£å‘³è‹±è¯­å­¦ä¹ </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            overflow: hidden;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            user-select: none;
        }

        /* æ¸¸æˆå®¹å™¨ */
        .game-container {
            width: 100%;
            max-width: 390px;
            height: 100vh;
            max-height: 844px;
            background: white;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 40px rgba(0,0,0,0.3);
        }

        /* é¡µé¢åŸºç¡€æ ·å¼ */
        .screen {
            position: absolute;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .screen.active {
            display: flex;
            opacity: 1;
            pointer-events: auto;
        }

        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideInUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes scaleIn {
            from {
                transform: scale(0.8);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3); }
            50% { box-shadow: 0 4px 25px rgba(78, 205, 196, 0.5); }
        }

        @keyframes moveGrid {
            0% { transform: translate(0, 0); }
            100% { transform: translate(20px, 20px); }
        }

        @keyframes twinkle {
            0%, 100% {
                opacity: 0.5;
                transform: scale(1) rotate(0deg);
            }
            50% {
                opacity: 1;
                transform: scale(1.3) rotate(180deg);
            }
        }

        @keyframes playerBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }

        @keyframes wordFloat {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-2px) scale(1.05); }
        }

        @keyframes wallBreak {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.5; }
            100% { transform: scale(0); opacity: 0; }
        }

        @keyframes collectWord {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(0); opacity: 0; }
        }

        /* æŒ‰é’®é€šç”¨æ ·å¼ */
        .btn {
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            touch-action: manipulation;
        }

        .btn:active {
            transform: scale(0.95);
        }

        .btn-primary {
            background: linear-gradient(135deg, #FF6B6B, #4ECDC4);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
            position: relative;
            animation: glow 2s ease-in-out infinite;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #FF5252, #40C4C0);
            box-shadow: 0 6px 30px rgba(255, 107, 107, 0.5);
            transform: translateY(-3px) scale(1.05);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, #5a67d8, #6b3aa0);
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.5);
            transform: translateY(-3px) scale(1.02);
        }

        .btn-green {
            background: linear-gradient(135deg, #11998e, #38ef7d);
            color: white;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
            box-shadow: 0 4px 15px rgba(17, 153, 142, 0.3);
        }

        .btn-green:hover {
            box-shadow: 0 6px 25px rgba(17, 153, 142, 0.5);
            transform: translateY(-3px) scale(1.02);
        }

        /* ============ é¦–é¡µæ ·å¼ ============ */
        #homeScreen {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            overflow: hidden;
        }

        #homeScreen::before {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            top: -50%;
            left: -50%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            animation: moveGrid 20s linear infinite;
            pointer-events: none;
        }

        .home-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 25px 20px 10px 20px;
            animation: fadeIn 0.5s ease-out;
            position: relative;
            z-index: 1;
            overflow-y: auto;
        }

        .logo-area {
            text-align: center;
            margin: 10px 0;
            animation: slideInUp 0.6s ease-out;
        }

        .maze-logo {
            font-size: 80px;
            margin-bottom: 10px;
            animation: pulse 2s ease-in-out infinite;
            filter: drop-shadow(0 10px 20px rgba(0,0,0,0.3));
        }

        .game-title {
            font-size: 32px;
            font-weight: bold;
            background: linear-gradient(45deg, #FFD700, #FFA500, #FF6347);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 10px 0 15px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .game-subtitle {
            font-size: 14px;
            color: rgba(255,255,255,0.8);
            margin-bottom: 20px;
        }

        .select-group {
            margin-top: 12px;
            animation: slideInUp 0.7s ease-out;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .select-label {
            color: rgba(255,255,255,0.9);
            font-size: 14px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .select-box {
            width: 100%;
            padding: 15px 20px;
            border: 3px solid transparent;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 500;
            background: rgba(255, 255, 255, 0.95);
            background-image: linear-gradient(white, white),
                              linear-gradient(45deg, #667eea, #764ba2);
            background-origin: border-box;
            background-clip: padding-box, border-box;
            color: #333;
            appearance: none;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
        }

        .select-box:focus {
            outline: none;
            transform: scale(1.02);
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.4);
        }

        .button-group {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            animation: slideInUp 0.8s ease-out;
        }

        .button-group .btn {
            width: 100%;
            padding: 16px;
            font-size: 17px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }

        .home-footer {
            margin-top: auto;
            padding: 15px 0;
            text-align: center;
        }

        .publisher-info {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(255,255,255,0.12);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.15);
            font-size: 12px;
        }

        .publisher-text {
            font-size: 12px;
            color: rgba(255,255,255,0.9);
            font-weight: 500;
        }

        .star-icon {
            font-size: 14px;
            animation: twinkle 2s ease-in-out infinite;
        }

        .star-icon:nth-child(3) {
            animation-delay: 1s;
        }

        /* ============ æ¸¸æˆé¡µé¢æ ·å¼ ============ */
        #gameScreen {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }

        /* é¡¶éƒ¨å¯¼èˆªæ  */
        .navbar {
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
        }

        .icon-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon-btn:active {
            transform: scale(0.9);
            background: rgba(255, 255, 255, 0.3);
        }

        .timer {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            color: white;
            font-weight: bold;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .timer.warning {
            background: rgba(255, 87, 87, 0.5);
            animation: pulse 0.5s ease-in-out infinite;
        }

        /* æ¸¸æˆä¿¡æ¯æ  */
        .game-info {
            display: flex;
            justify-content: space-around;
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.1);
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 5px;
            color: white;
            font-size: 14px;
        }

        .info-icon {
            font-size: 18px;
        }

        .info-value {
            font-weight: bold;
            color: #4ECDC4;
        }

        /* è¿·å®«å®¹å™¨ */
        .maze-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px;
            overflow: hidden;
        }

        .maze-grid {
            display: grid;
            gap: 2px;
            background: rgba(0, 0, 0, 0.3);
            padding: 5px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        .maze-cell {
            width: 100%;
            aspect-ratio: 1;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            position: relative;
        }

        .maze-cell.wall {
            background: linear-gradient(135deg, #4a4a6a, #2d2d44);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .maze-cell.path {
            background: linear-gradient(135deg, #2d3a4f, #1e2738);
        }

        .maze-cell.start {
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
        }

        .maze-cell.end {
            background: linear-gradient(135deg, #FF5722, #FF9800);
            box-shadow: 0 0 10px rgba(255, 87, 34, 0.5);
        }

        .maze-cell.end::after {
            content: 'ğŸšª';
            font-size: 20px;
        }

        .maze-cell.breakable {
            background: linear-gradient(135deg, #9C27B0, #673AB7);
            box-shadow: 0 0 8px rgba(156, 39, 176, 0.4);
        }

        .maze-cell.breaking {
            animation: wallBreak 0.5s forwards;
        }

        /* ç©å®¶è§’è‰² */
        .player {
            position: absolute;
            font-size: 24px;
            z-index: 100;
            transition: all 0.15s ease-out;
            animation: playerBounce 1s ease-in-out infinite;
            filter: drop-shadow(0 3px 5px rgba(0, 0, 0, 0.3));
            cursor: grab;
        }

        .player:active {
            cursor: grabbing;
            animation: none;
            transform: scale(1.2);
        }

        /* å•è¯é“å…· */
        .word-item {
            position: absolute;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: bold;
            color: #333;
            box-shadow: 0 2px 8px rgba(255, 215, 0, 0.5);
            animation: wordFloat 2s ease-in-out infinite;
            z-index: 50;
            white-space: nowrap;
        }

        .word-item.collecting {
            animation: collectWord 0.3s forwards;
        }

        /* å•è¯æç¤ºå¼¹çª— */
        .word-popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            z-index: 1000;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            animation: scaleIn 0.3s ease-out;
            max-width: 300px;
            width: 90%;
        }

        .word-popup.active {
            display: block;
        }

        .popup-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 999;
        }

        .popup-overlay.active {
            display: block;
        }

        .popup-word {
            font-size: 36px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .popup-chinese {
            font-size: 24px;
            color: #4CAF50;
            margin-bottom: 10px;
        }

        .popup-example {
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .popup-effect {
            background: linear-gradient(135deg, #9C27B0, #673AB7);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 14px;
            margin-bottom: 15px;
        }

        /* åº•éƒ¨æç¤º */
        .game-hint {
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.1);
            text-align: center;
            color: rgba(255, 255, 255, 0.7);
            font-size: 12px;
        }

        /* ============ æ¸¸æˆç»“æŸé¡µé¢ ============ */
        #gameOverScreen {
            background: linear-gradient(to bottom, #E3F2FD, #BBDEFB);
        }

        #gameOverScreen.victory {
            background: linear-gradient(to bottom, #E8F5E9, #C8E6C9);
        }

        #gameOverScreen.defeat {
            background: linear-gradient(to bottom, #FFEBEE, #FFCDD2);
        }

        .game-over-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            animation: fadeIn 0.5s ease-out;
        }

        .result-header {
            text-align: center;
            margin-bottom: 20px;
            animation: scaleIn 0.6s ease-out;
        }

        .result-icons {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
            font-size: 50px;
        }

        .result-title {
            font-size: 24px;
            color: #333;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .result-subtitle {
            color: #666;
            font-size: 14px;
        }

        /* ç»Ÿè®¡å¡ç‰‡ */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
            animation: slideInUp 0.7s ease-out;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .stat-icon {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
        }

        /* å•è¯å›é¡¾åŒºåŸŸ */
        .word-review-section {
            background: white;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 100px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            animation: slideInUp 0.8s ease-out;
        }

        .review-title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title {
            font-size: 14px;
            font-weight: bold;
            margin: 15px 0 10px 0;
            padding: 8px 12px;
            border-radius: 8px;
        }

        .section-title.correct {
            background: rgba(76, 175, 80, 0.1);
            color: #4CAF50;
        }

        .section-title.wrong {
            background: rgba(244, 67, 54, 0.1);
            color: #f44336;
        }

        .word-review-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .review-word-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .review-word-item:hover {
            transform: scale(1.02);
        }

        .review-word-item.correct {
            background: rgba(76, 175, 80, 0.1);
            border-left: 4px solid #4CAF50;
        }

        .review-word-item.wrong {
            background: rgba(244, 67, 54, 0.15);
            border-left: 4px solid #f44336;
        }

        .word-en {
            font-size: 16px;
            font-weight: bold;
            color: #333;
        }

        .word-cn {
            font-size: 14px;
            color: #666;
        }

        .word-speak-btn {
            font-size: 20px;
            background: none;
            border: none;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .word-speak-btn:hover {
            transform: scale(1.2);
        }

        /* åº•éƒ¨æŒ‰é’® */
        .game-over-buttons {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: calc(100% - 40px);
            max-width: 350px;
            display: flex;
            gap: 10px;
        }

        .game-over-buttons .btn {
            flex: 1;
            padding: 14px;
            font-size: 15px;
        }

        /* å“ç‰Œç½²å */
        .brand-signature {
            text-align: center;
            padding: 15px;
            color: rgba(102, 126, 234, 0.8);
            font-size: 12px;
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
        }

        /* æš‚åœå¼¹çª— */
        .pause-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }

        .pause-modal.active {
            display: flex;
        }

        .pause-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            animation: scaleIn 0.3s ease-out;
            max-width: 300px;
            width: 90%;
        }

        .pause-title {
            font-size: 24px;
            color: #333;
            margin-bottom: 10px;
        }

        .pause-subtitle {
            font-size: 14px;
            color: #666;
            margin-bottom: 20px;
        }

        .pause-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        /* æ¸¸æˆè¯´æ˜å¼¹çª— */
        .help-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.85);
            z-index: 10000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .help-modal.active {
            display: flex;
            animation: fadeIn 0.3s;
        }

        .help-content {
            background: white;
            border-radius: 20px;
            padding: 25px;
            max-width: 350px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            animation: scaleIn 0.3s;
        }

        .help-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .help-title {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .close-help {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #f5f5f5;
            border: none;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .close-help:hover {
            background: #FF5252;
            color: white;
            transform: rotate(90deg);
        }

        .help-section {
            margin-bottom: 20px;
        }

        .help-section h3 {
            font-size: 16px;
            color: #667eea;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .help-section p {
            font-size: 14px;
            color: #666;
            line-height: 1.6;
            margin-bottom: 8px;
        }

        .help-list {
            list-style: none;
            padding: 0;
        }

        .help-list li {
            font-size: 13px;
            color: #666;
            padding: 5px 0;
            padding-left: 20px;
            position: relative;
        }

        .help-list li:before {
            content: "â–¸";
            position: absolute;
            left: 0;
            color: #4CAF50;
        }

        /* Toastæç¤º */
        .toast {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            background: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            font-size: 14px;
            z-index: 10001;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
            text-align: center;
            max-width: 280px;
        }

        .toast.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        /* å“åº”å¼é€‚é… */
        @media (max-height: 700px) {
            .maze-logo {
                font-size: 60px;
            }

            .game-title {
                font-size: 26px;
            }

            .button-group .btn {
                padding: 12px;
                font-size: 15px;
            }
        }

        @media (min-width: 768px) {
            .game-container {
                border-radius: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- ============ é¦–é¡µ ============ -->
        <div id="homeScreen" class="screen active">
            <div class="home-content">
                <div class="logo-area">
                    <div class="maze-logo">ğŸ§©</div>
                    <h1 class="game-title">å•è¯è¿·å®«</h1>
                    <p class="game-subtitle">æ‹–åŠ¨å°äººç©¿è¶Šè¿·å®«ï¼Œæ”¶é›†å•è¯å¼€è¾Ÿæ·å¾„ï¼</p>
                </div>

                <div class="select-group">
                    <div class="select-label">ğŸ“š é€‰æ‹©å¹´çº§</div>
                    <select id="gradeSelect" class="select-box">
                        <option value="1">1å¹´çº§ - åŸºç¡€è¯æ±‡</option>
                        <option value="2">2å¹´çº§ - è¿›é˜¶è¯æ±‡</option>
                        <option value="3">3å¹´çº§ - ä¸­çº§è¯æ±‡</option>
                        <option value="4">4å¹´çº§ - é«˜çº§è¯æ±‡</option>
                        <option value="5">5å¹´çº§ - æŒ‘æˆ˜è¯æ±‡</option>
                        <option value="6">6å¹´çº§ - ç²¾è‹±è¯æ±‡</option>
                    </select>
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="startGame()">ğŸš€ å¼€å§‹æ¸¸æˆ</button>
                    <button class="btn btn-secondary" onclick="showHelp()">ğŸ“– æ¸¸æˆè¯´æ˜</button>
                </div>

                <div class="home-footer">
                    <div class="publisher-info">
                        <span class="star-icon">â­</span>
                        <span class="publisher-text">åˆ¶ä½œbyå…¬ä¼—å·:æ³¡æ³¡å¦ˆå­¦AI</span>
                        <span class="star-icon">â­</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ============ æ¸¸æˆé¡µé¢ ============ -->
        <div id="gameScreen" class="screen">
            <!-- å¯¼èˆªæ  -->
            <div class="navbar">
                <button class="icon-btn" id="backBtn" onclick="showPauseMenu()">ğŸ”™</button>
                <button class="icon-btn" id="pauseBtn" onclick="togglePause()">â¸ï¸</button>
                <button class="icon-btn" id="refreshBtn" onclick="restartGame()">ğŸ”„</button>
                <div class="timer" id="timerDisplay">â±ï¸ <span id="timeDisplay">01:00</span></div>
                <button class="icon-btn" id="volumeBtn" onclick="toggleSound()">ğŸ”Š</button>
                <button class="icon-btn" id="helpBtn" onclick="showHelp()">â“</button>
            </div>

            <!-- æ¸¸æˆä¿¡æ¯ -->
            <div class="game-info">
                <div class="info-item">
                    <span class="info-icon">ğŸ“</span>
                    <span>å•è¯: </span>
                    <span class="info-value" id="wordCount">0/5</span>
                </div>
                <div class="info-item">
                    <span class="info-icon">ğŸ§±</span>
                    <span>å¯ç ´å¢™: </span>
                    <span class="info-value" id="breakCount">0</span>
                </div>
            </div>

            <!-- è¿·å®«åŒºåŸŸ -->
            <div class="maze-container">
                <div class="maze-grid" id="mazeGrid">
                    <!-- è¿·å®«æ ¼å­åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>

            <!-- åº•éƒ¨æç¤º -->
            <div class="game-hint">
                ğŸ’¡ æ‹–åŠ¨å°äººç§»åŠ¨ï¼Œæ”¶é›†å•è¯å¯ä»¥ç ´é™¤ä¸€å µå¢™
            </div>
        </div>

        <!-- ============ æ¸¸æˆç»“æŸé¡µé¢ ============ -->
        <div id="gameOverScreen" class="screen">
            <div class="game-over-content">
                <div class="result-header">
                    <div class="result-icons" id="resultIcons">ğŸ‰ğŸ†ğŸ‰</div>
                    <h2 class="result-title" id="resultTitle">æ­å–œé€šå…³ï¼</h2>
                    <p class="result-subtitle" id="resultSubtitle">ä½ æˆåŠŸèµ°å‡ºäº†è¿·å®«</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">â±ï¸</div>
                        <div class="stat-value" id="statTime">00:45</div>
                        <div class="stat-label">ç”¨æ—¶</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ“</div>
                        <div class="stat-value" id="statWords">5</div>
                        <div class="stat-label">æ”¶é›†å•è¯</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ§±</div>
                        <div class="stat-value" id="statWalls">3</div>
                        <div class="stat-label">ç ´é™¤å¢™å£</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ¯</div>
                        <div class="stat-value" id="statScore">100</div>
                        <div class="stat-label">å¾—åˆ†</div>
                    </div>
                </div>

                <!-- å•è¯å›é¡¾ -->
                <div class="word-review-section">
                    <h3 class="review-title">ğŸ“– æœ¬å±€å•è¯å›é¡¾</h3>

                    <h4 class="section-title correct" id="correctTitle">âœ… æ”¶é›†çš„å•è¯ (0ä¸ª)</h4>
                    <div class="word-review-list" id="correctWordsList">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </div>

                    <h4 class="section-title wrong" id="missedTitle">âŒ é”™è¿‡çš„å•è¯ (0ä¸ª)</h4>
                    <div class="word-review-list" id="missedWordsList">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <div class="brand-signature">
                    â­ åˆ¶ä½œbyå…¬ä¼—å·:æ³¡æ³¡å¦ˆå­¦AI â­
                </div>
            </div>

            <div class="game-over-buttons">
                <button class="btn btn-primary" onclick="restartGame()">ğŸ”„ å†ç©ä¸€æ¬¡</button>
                <button class="btn btn-secondary" onclick="goHome()">ğŸ  è¿”å›é¦–é¡µ</button>
            </div>
        </div>
    </div>

    <!-- æš‚åœå¼¹çª—ï¼ˆä»…ç”¨äºè¿”å›é¦–é¡µç¡®è®¤ï¼‰ -->
    <div class="pause-modal" id="pauseModal">
        <div class="pause-content">
            <div class="pause-title">â¸ï¸ æ¸¸æˆæš‚åœ</div>
            <p class="pause-subtitle">ä¼‘æ¯ä¸€ä¸‹ï¼Œå‡†å¤‡å¥½å†ç»§ç»­ï¼</p>
            <div class="pause-buttons">
                <button class="btn btn-primary" onclick="closePauseMenu()">â–¶ï¸ ç»§ç»­æ¸¸æˆ</button>
                <button class="btn btn-green" onclick="restartGame()">ğŸ”„ é‡æ–°å¼€å§‹</button>
                <button class="btn btn-secondary" onclick="goHome()">ğŸ  è¿”å›é¦–é¡µ</button>
            </div>
        </div>
    </div>

    <!-- å•è¯å¼¹çª— -->
    <div class="popup-overlay" id="wordOverlay"></div>
    <div class="word-popup" id="wordPopup">
        <div class="popup-word" id="popupWord">Apple</div>
        <div class="popup-chinese" id="popupChinese">è‹¹æœ</div>
        <div class="popup-example" id="popupExample">The apple is red. è‹¹æœæ˜¯çº¢è‰²çš„ã€‚</div>
        <div class="popup-effect">ğŸ§± å¯ä»¥ç ´é™¤ä¸€å µå¢™ï¼</div>
        <button class="btn btn-primary" onclick="closeWordPopup()">ç»§ç»­æ¢ç´¢</button>
    </div>

    <!-- æ¸¸æˆè¯´æ˜å¼¹çª— -->
    <div class="help-modal" id="helpModal">
        <div class="help-content">
            <div class="help-header">
                <span class="help-title">ğŸ“– æ¸¸æˆè¯´æ˜</span>
                <button class="close-help" onclick="closeHelp()">Ã—</button>
            </div>

            <div class="help-section">
                <h3>ğŸ¯ æ¸¸æˆç›®æ ‡</h3>
                <p>åœ¨1åˆ†é’Ÿå†…ï¼Œæ‹–åŠ¨å°äººä»èµ·ç‚¹ğŸŸ¢èµ°åˆ°å‡ºå£ğŸšªï¼ŒæˆåŠŸé€ƒç¦»è¿·å®«ï¼</p>
            </div>

            <div class="help-section">
                <h3>ğŸ® æ“ä½œæ–¹å¼</h3>
                <ul class="help-list">
                    <li>æ‰‹æŒ‡æŒ‰ä½å°äººğŸ‘¦ï¼Œæ‹–åŠ¨åˆ°ç›¸é‚»çš„é€šé“æ ¼å­</li>
                    <li>åªèƒ½èµ°é€šé“ï¼Œä¸èƒ½ç©¿å¢™</li>
                    <li>æ¾æ‰‹åå°äººä¼šåœåœ¨å½“å‰ä½ç½®</li>
                </ul>
            </div>

            <div class="help-section">
                <h3>ğŸ“ å•è¯æ”¶é›†</h3>
                <ul class="help-list">
                    <li>è¿·å®«ä¸­æœ‰5ä¸ªå•è¯ï¼Œè§¦ç¢°å³å¯æ”¶é›†</li>
                    <li>æ”¶é›†å•è¯ä¼šå¼¹å‡ºä¸­æ–‡é‡Šä¹‰å’Œæœ—è¯»</li>
                    <li>æ¯æ”¶é›†1ä¸ªå•è¯ï¼Œå¯ä»¥ç ´é™¤1å µç´«è‰²çš„å¢™</li>
                </ul>
            </div>

            <div class="help-section">
                <h3>ğŸ§± ç ´å¢™æŠ€å·§</h3>
                <ul class="help-list">
                    <li>ç´«è‰²å¢™å£å¯ä»¥è¢«ç ´é™¤</li>
                    <li>æ”¶é›†å•è¯åï¼Œç‚¹å‡»ç´«è‰²å¢™å£å³å¯ç ´é™¤</li>
                    <li>åˆç†ç ´å¢™å¯ä»¥å¼€è¾Ÿæ·å¾„ï¼Œæ›´å¿«åˆ°è¾¾å‡ºå£</li>
                </ul>
            </div>

            <div class="help-section">
                <h3>â±ï¸ æ—¶é—´é™åˆ¶</h3>
                <p>æ¸¸æˆé™æ—¶1åˆ†é’Ÿï¼Œå€’è®¡æ—¶ç»“æŸå‰å¿…é¡»åˆ°è¾¾å‡ºå£ï¼Œå¦åˆ™æŒ‘æˆ˜å¤±è´¥ï¼</p>
            </div>
        </div>
    </div>

    <!-- Toastæç¤º -->
    <div class="toast" id="toast"></div>

    <script>
        // ============ å•è¯æ•°æ®åº“ ============
        const wordDatabase = {
            1: [
                { word: 'Cat', chinese: 'çŒ«', pronunciation: '/kÃ¦t/', example: 'The cat is sleeping. çŒ«åœ¨ç¡è§‰ã€‚' },
                { word: 'Dog', chinese: 'ç‹—', pronunciation: '/dÉ’É¡/', example: 'My dog is friendly. æˆ‘çš„ç‹—å¾ˆå‹å¥½ã€‚' },
                { word: 'Bird', chinese: 'é¸Ÿ', pronunciation: '/bÉœËrd/', example: 'Birds can fly. é¸Ÿä¼šé£ã€‚' },
                { word: 'Fish', chinese: 'é±¼', pronunciation: '/fÉªÊƒ/', example: 'Fish live in water. é±¼ç”Ÿæ´»åœ¨æ°´é‡Œã€‚' },
                { word: 'Rabbit', chinese: 'å…”å­', pronunciation: '/ËˆrÃ¦bÉªt/', example: 'The rabbit is white. å…”å­æ˜¯ç™½è‰²çš„ã€‚' },
                { word: 'Duck', chinese: 'é¸­å­', pronunciation: '/dÊŒk/', example: 'Ducks swim in the pond. é¸­å­åœ¨æ± å¡˜é‡Œæ¸¸æ³³ã€‚' },
                { word: 'Pig', chinese: 'çŒª', pronunciation: '/pÉªÉ¡/', example: 'The pig is pink. çŒªæ˜¯ç²‰è‰²çš„ã€‚' },
                { word: 'Cow', chinese: 'ç‰›', pronunciation: '/kaÊŠ/', example: 'Cows give us milk. ç‰›ç»™æˆ‘ä»¬ç‰›å¥¶ã€‚' },
                { word: 'Horse', chinese: 'é©¬', pronunciation: '/hÉ”Ërs/', example: 'The horse runs fast. é©¬è·‘å¾—å¾ˆå¿«ã€‚' },
                { word: 'Apple', chinese: 'è‹¹æœ', pronunciation: '/ËˆÃ¦pÉ™l/', example: 'The apple is sweet. è‹¹æœå¾ˆç”œã€‚' },
                { word: 'Banana', chinese: 'é¦™è•‰', pronunciation: '/bÉ™ËˆnÃ¦nÉ™/', example: 'Monkeys like bananas. çŒ´å­å–œæ¬¢é¦™è•‰ã€‚' },
                { word: 'Red', chinese: 'çº¢è‰²', pronunciation: '/red/', example: 'The apple is red. è‹¹æœæ˜¯çº¢è‰²çš„ã€‚' },
                { word: 'Blue', chinese: 'è“è‰²', pronunciation: '/bluË/', example: 'The sky is blue. å¤©ç©ºæ˜¯è“è‰²çš„ã€‚' },
                { word: 'Green', chinese: 'ç»¿è‰²', pronunciation: '/É¡riËn/', example: 'Grass is green. è‰æ˜¯ç»¿è‰²çš„ã€‚' },
                { word: 'Yellow', chinese: 'é»„è‰²', pronunciation: '/ËˆjelÉ™ÊŠ/', example: 'The sun is yellow. å¤ªé˜³æ˜¯é»„è‰²çš„ã€‚' },
                { word: 'Book', chinese: 'ä¹¦', pronunciation: '/bÊŠk/', example: 'I read a book. æˆ‘è¯»ä¸€æœ¬ä¹¦ã€‚' },
                { word: 'Pen', chinese: 'é’¢ç¬”', pronunciation: '/pen/', example: 'Write with a pen. ç”¨é’¢ç¬”å†™å­—ã€‚' },
                { word: 'Ball', chinese: 'çƒ', pronunciation: '/bÉ”Ël/', example: 'Throw the ball. æ‰”çƒã€‚' },
                { word: 'Sun', chinese: 'å¤ªé˜³', pronunciation: '/sÊŒn/', example: 'The sun is bright. å¤ªé˜³å¾ˆäº®ã€‚' },
                { word: 'Moon', chinese: 'æœˆäº®', pronunciation: '/muËn/', example: 'The moon is round. æœˆäº®æ˜¯åœ†çš„ã€‚' }
            ],
            2: [
                { word: 'School', chinese: 'å­¦æ ¡', pronunciation: '/skuËl/', example: 'I go to school every day. æˆ‘æ¯å¤©éƒ½å»å­¦æ ¡ã€‚' },
                { word: 'Teacher', chinese: 'è€å¸ˆ', pronunciation: '/ËˆtiËtÊƒÉ™r/', example: 'My teacher is kind. æˆ‘çš„è€å¸ˆå¾ˆå‹å–„ã€‚' },
                { word: 'Student', chinese: 'å­¦ç”Ÿ', pronunciation: '/ËˆstuËdÉ™nt/', example: 'I am a good student. æˆ‘æ˜¯ä¸€ä¸ªå¥½å­¦ç”Ÿã€‚' },
                { word: 'Homework', chinese: 'ä½œä¸š', pronunciation: '/ËˆhoÊŠmwÉœËrk/', example: 'Do your homework first. å…ˆåšä½ çš„ä½œä¸šã€‚' },
                { word: 'Pencil', chinese: 'é“…ç¬”', pronunciation: '/ËˆpensÉ™l/', example: 'Draw with a pencil. ç”¨é“…ç¬”ç”»ç”»ã€‚' },
                { word: 'Eraser', chinese: 'æ©¡çš®æ“¦', pronunciation: '/ÉªËˆreÉªsÉ™r/', example: 'The eraser removes pencil marks. æ©¡çš®æ“¦èƒ½æ“¦æ‰é“…ç¬”å°ã€‚' },
                { word: 'Table', chinese: 'æ¡Œå­', pronunciation: '/ËˆteÉªbÉ™l/', example: 'The book is on the table. ä¹¦åœ¨æ¡Œå­ä¸Šã€‚' },
                { word: 'Chair', chinese: 'æ¤…å­', pronunciation: '/tÊƒer/', example: 'Sit on the chair. ååœ¨æ¤…å­ä¸Šã€‚' },
                { word: 'Window', chinese: 'çª—æˆ·', pronunciation: '/ËˆwÉªndÉ™ÊŠ/', example: 'Open the window. æ‰“å¼€çª—æˆ·ã€‚' },
                { word: 'Door', chinese: 'é—¨', pronunciation: '/dÉ”Ër/', example: 'Close the door. å…³é—¨ã€‚' },
                { word: 'Mother', chinese: 'æ¯äº²', pronunciation: '/ËˆmÊŒÃ°É™r/', example: 'My mother loves me. æˆ‘å¦ˆå¦ˆçˆ±æˆ‘ã€‚' },
                { word: 'Father', chinese: 'çˆ¶äº²', pronunciation: '/ËˆfÉ‘ËÃ°É™r/', example: 'Father is working. çˆ¸çˆ¸åœ¨å·¥ä½œã€‚' },
                { word: 'Sister', chinese: 'å§å¦¹', pronunciation: '/ËˆsÉªstÉ™r/', example: 'My sister is tall. æˆ‘å§å§å¾ˆé«˜ã€‚' },
                { word: 'Brother', chinese: 'å…„å¼Ÿ', pronunciation: '/ËˆbrÊŒÃ°É™r/', example: 'My brother plays soccer. æˆ‘å“¥å“¥è¸¢è¶³çƒã€‚' },
                { word: 'Friend', chinese: 'æœ‹å‹', pronunciation: '/frend/', example: 'You are my best friend. ä½ æ˜¯æˆ‘æœ€å¥½çš„æœ‹å‹ã€‚' },
                { word: 'Happy', chinese: 'å¿«ä¹çš„', pronunciation: '/ËˆhÃ¦pi/', example: 'I am happy today. æˆ‘ä»Šå¤©å¾ˆå¿«ä¹ã€‚' },
                { word: 'Sad', chinese: 'æ‚²ä¼¤çš„', pronunciation: '/sÃ¦d/', example: "Don't be sad. ä¸è¦æ‚²ä¼¤ã€‚" },
                { word: 'Weather', chinese: 'å¤©æ°”', pronunciation: '/ËˆweÃ°É™r/', example: 'How is the weather today? ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ' },
                { word: 'Sunny', chinese: 'æ™´æœ—çš„', pronunciation: '/ËˆsÊŒni/', example: 'Today is sunny. ä»Šå¤©å¤©æ°”æ™´æœ—ã€‚' },
                { word: 'Rainy', chinese: 'ä¸‹é›¨çš„', pronunciation: '/ËˆreÉªni/', example: 'Take an umbrella on rainy days. é›¨å¤©è¦å¸¦ä¼ã€‚' }
            ],
            3: [
                { word: 'Geography', chinese: 'åœ°ç†', pronunciation: '/dÊ’iËˆÉ‘ËÉ¡rÉ™fi/', example: 'Geography teaches us about the world. åœ°ç†æ•™æˆ‘ä»¬äº†è§£ä¸–ç•Œã€‚' },
                { word: 'History', chinese: 'å†å²', pronunciation: '/ËˆhÉªstÉ™ri/', example: 'History tells us about the past. å†å²å‘Šè¯‰æˆ‘ä»¬è¿‡å»çš„äº‹æƒ…ã€‚' },
                { word: 'Science', chinese: 'ç§‘å­¦', pronunciation: '/ËˆsaÉªÉ™ns/', example: 'Science is interesting. ç§‘å­¦å¾ˆæœ‰è¶£ã€‚' },
                { word: 'Library', chinese: 'å›¾ä¹¦é¦†', pronunciation: '/ËˆlaÉªbreri/', example: 'Books are in the library. ä¹¦åœ¨å›¾ä¹¦é¦†é‡Œã€‚' },
                { word: 'Museum', chinese: 'åšç‰©é¦†', pronunciation: '/mjuËˆziËÉ™m/', example: 'We visited the museum. æˆ‘ä»¬å‚è§‚äº†åšç‰©é¦†ã€‚' },
                { word: 'Hospital', chinese: 'åŒ»é™¢', pronunciation: '/ËˆhÉ’spÉªtl/', example: 'Doctors work in the hospital. åŒ»ç”Ÿåœ¨åŒ»é™¢å·¥ä½œã€‚' },
                { word: 'Restaurant', chinese: 'é¤å…', pronunciation: '/ËˆrestrÉ’nt/', example: 'We eat at the restaurant. æˆ‘ä»¬åœ¨é¤å…åƒé¥­ã€‚' },
                { word: 'Airport', chinese: 'æœºåœº', pronunciation: '/ËˆerpÉ”Ërt/', example: 'Planes take off from the airport. é£æœºä»æœºåœºèµ·é£ã€‚' },
                { word: 'Mountain', chinese: 'å±±', pronunciation: '/ËˆmaÊŠntÉ™n/', example: 'Mountains are high. å±±å¾ˆé«˜ã€‚' },
                { word: 'Ocean', chinese: 'æµ·æ´‹', pronunciation: '/ËˆÉ™ÊŠÊƒn/', example: 'The ocean is blue and deep. æµ·æ´‹æ˜¯è“è‰²ä¸”æ·±é‚ƒçš„ã€‚' },
                { word: 'Island', chinese: 'å²›å±¿', pronunciation: '/ËˆaÉªlÉ™nd/', example: 'The island is beautiful. è¿™ä¸ªå²›å±¿å¾ˆç¾ä¸½ã€‚' },
                { word: 'Desert', chinese: 'æ²™æ¼ ', pronunciation: '/ËˆdezÉ™t/', example: 'The desert is hot and dry. æ²™æ¼ åˆçƒ­åˆå¹²ã€‚' },
                { word: 'Forest', chinese: 'æ£®æ—', pronunciation: '/ËˆfÉ’rÉªst/', example: 'Animals live in the forest. åŠ¨ç‰©ç”Ÿæ´»åœ¨æ£®æ—é‡Œã€‚' },
                { word: 'Jungle', chinese: 'ä¸›æ—', pronunciation: '/ËˆdÊ’ÊŒÅ‹É¡l/', example: 'The jungle is full of trees. ä¸›æ—é‡Œåˆ°å¤„éƒ½æ˜¯æ ‘ã€‚' },
                { word: 'Planet', chinese: 'è¡Œæ˜Ÿ', pronunciation: '/ËˆplÃ¦nÉªt/', example: 'Earth is a planet. åœ°çƒæ˜¯ä¸€é¢—è¡Œæ˜Ÿã€‚' },
                { word: 'Universe', chinese: 'å®‡å®™', pronunciation: '/ËˆjuËnÉªvÉœËrs/', example: 'The universe is vast. å®‡å®™æ˜¯å¹¿é˜”çš„ã€‚' },
                { word: 'Adventure', chinese: 'å†’é™©', pronunciation: '/É™dËˆventÊƒÉ™r/', example: 'I love adventure. æˆ‘å–œæ¬¢å†’é™©ã€‚' },
                { word: 'Journey', chinese: 'æ—…ç¨‹', pronunciation: '/ËˆdÊ’ÉœËrni/', example: 'Life is a journey. ç”Ÿæ´»æ˜¯ä¸€æ®µæ—…ç¨‹ã€‚' },
                { word: 'Discovery', chinese: 'å‘ç°', pronunciation: '/dÉªËˆskÊŒvÉ™ri/', example: 'Scientists make discoveries. ç§‘å­¦å®¶ä»¬åšå‡ºå‘ç°ã€‚' },
                { word: 'Explorer', chinese: 'æ¢é™©å®¶', pronunciation: '/ÉªkËˆsplÉ”ËrÉ™r/', example: 'The explorer found a new land. æ¢é™©å®¶å‘ç°äº†æ–°å¤§é™†ã€‚' }
            ],
            4: [
                { word: 'Astronomy', chinese: 'å¤©æ–‡å­¦', pronunciation: '/É™ËˆstrÉ’nÉ™mi/', example: 'Astronomy studies the stars. å¤©æ–‡å­¦ç ”ç©¶æ˜Ÿæ˜Ÿã€‚' },
                { word: 'Ecosystem', chinese: 'ç”Ÿæ€ç³»ç»Ÿ', pronunciation: '/ËˆiËkÉ™ÊŠsÉªstÉ™m/', example: 'The rainforest is an ecosystem. é›¨æ—æ˜¯ä¸€ä¸ªç”Ÿæ€ç³»ç»Ÿã€‚' },
                { word: 'Atmosphere', chinese: 'å¤§æ°”å±‚', pronunciation: '/ËˆÃ¦tmÉ™sfÉªÉ™r/', example: 'The atmosphere protects the Earth. å¤§æ°”å±‚ä¿æŠ¤åœ°çƒã€‚' },
                { word: 'Continent', chinese: 'å¤§é™†', pronunciation: '/ËˆkÉ’ntÉªnÉ™nt/', example: 'Asia is the largest continent. äºšæ´²æ˜¯æœ€å¤§çš„å¤§é™†ã€‚' },
                { word: 'Population', chinese: 'äººå£', pronunciation: '/ËŒpÉ’pjuËˆleÉªÊƒn/', example: 'The population is growing. äººå£åœ¨å¢é•¿ã€‚' },
                { word: 'Government', chinese: 'æ”¿åºœ', pronunciation: '/ËˆÉ¡ÊŒvÉ™nmÉ™nt/', example: 'The government makes laws. æ”¿åºœåˆ¶å®šæ³•å¾‹ã€‚' },
                { word: 'Democracy', chinese: 'æ°‘ä¸»', pronunciation: '/dÉªËˆmÉ’krÉ™si/', example: 'Democracy means people rule. æ°‘ä¸»æ„å‘³ç€äººæ°‘ç»Ÿæ²»ã€‚' },
                { word: 'Technology', chinese: 'æŠ€æœ¯', pronunciation: '/tekËˆnÉ’lÉ™dÊ’i/', example: 'Technology changes our lives. æŠ€æœ¯æ”¹å˜æˆ‘ä»¬çš„ç”Ÿæ´»ã€‚' },
                { word: 'Innovation', chinese: 'åˆ›æ–°', pronunciation: '/ËŒÉªnÉ™ËˆveÉªÊƒn/', example: 'Innovation drives progress. åˆ›æ–°æ¨åŠ¨è¿›æ­¥ã€‚' },
                { word: 'Experiment', chinese: 'å®éªŒ', pronunciation: '/ÉªkËˆsperÉªmÉ™nt/', example: 'Scientists do experiments. ç§‘å­¦å®¶åšå®éªŒã€‚' },
                { word: 'Laboratory', chinese: 'å®éªŒå®¤', pronunciation: '/lÉ™ËˆbÉ’rÉ™tri/', example: 'Research happens in the laboratory. ç ”ç©¶åœ¨å®éªŒå®¤è¿›è¡Œã€‚' },
                { word: 'Electricity', chinese: 'ç”µ', pronunciation: '/ÉªËŒlekËˆtrÉªsÉ™ti/', example: 'Electricity powers our homes. ç”µåŠ›ä¸ºæˆ‘ä»¬çš„å®¶ä¾›ç”µã€‚' },
                { word: 'Telescope', chinese: 'æœ›è¿œé•œ', pronunciation: '/ËˆtelÉªskÉ™ÊŠp/', example: 'We use a telescope to see stars. æˆ‘ä»¬ç”¨æœ›è¿œé•œçœ‹æ˜Ÿæ˜Ÿã€‚' },
                { word: 'Microscope', chinese: 'æ˜¾å¾®é•œ', pronunciation: '/ËˆmaÉªkrÉ™skÉ™ÊŠp/', example: 'A microscope shows tiny things. æ˜¾å¾®é•œæ˜¾ç¤ºå¾®å°çš„ä¸œè¥¿ã€‚' },
                { word: 'Chemical', chinese: 'åŒ–å­¦çš„', pronunciation: '/ËˆkemÉªkl/', example: 'Chemical reactions create energy. åŒ–å­¦ååº”äº§ç”Ÿèƒ½é‡ã€‚' },
                { word: 'Particle', chinese: 'ç²’å­', pronunciation: '/ËˆpÉ‘ËtÉªkl/', example: 'Atoms are tiny particles. åŸå­æ˜¯å¾®å°çš„ç²’å­ã€‚' },
                { word: 'Molecule', chinese: 'åˆ†å­', pronunciation: '/ËˆmÉ’lÉªkjuËl/', example: 'Water is made of molecules. æ°´ç”±åˆ†å­ç»„æˆã€‚' },
                { word: 'Evolution', chinese: 'è¿›åŒ–', pronunciation: '/ËŒiËvÉ™ËˆluËÊƒn/', example: 'Evolution takes millions of years. è¿›åŒ–éœ€è¦æ•°ç™¾ä¸‡å¹´ã€‚' },
                { word: 'Civilization', chinese: 'æ–‡æ˜', pronunciation: '/ËŒsÉªvÉ™laÉªËˆzeÉªÊƒn/', example: 'Ancient civilizations built pyramids. å¤ä»£æ–‡æ˜å»ºé€ äº†é‡‘å­—å¡”ã€‚' },
                { word: 'Architecture', chinese: 'å»ºç­‘å­¦', pronunciation: '/ËˆÉ‘ËkÉªtektÊƒÉ™r/', example: 'Architecture is the art of building. å»ºç­‘å­¦æ˜¯å»ºç­‘çš„è‰ºæœ¯ã€‚' }
            ],
            5: [
                { word: 'Phenomenon', chinese: 'ç°è±¡', pronunciation: '/fÉ™ËˆnÉ’mÉªnÉ™n/', example: 'A rainbow is a natural phenomenon. å½©è™¹æ˜¯ä¸€ç§è‡ªç„¶ç°è±¡ã€‚' },
                { word: 'Hypothesis', chinese: 'å‡è®¾', pronunciation: '/haÉªËˆpÉ’Î¸É™sÉªs/', example: 'Scientists test their hypothesis. ç§‘å­¦å®¶æµ‹è¯•ä»–ä»¬çš„å‡è®¾ã€‚' },
                { word: 'Environment', chinese: 'ç¯å¢ƒ', pronunciation: '/ÉªnËˆvaÉªrÉ™nmÉ™nt/', example: 'Protect the environment. ä¿æŠ¤ç¯å¢ƒã€‚' },
                { word: 'Sustainable', chinese: 'å¯æŒç»­çš„', pronunciation: '/sÉ™ËˆsteÉªnÉ™bl/', example: 'We need sustainable energy. æˆ‘ä»¬éœ€è¦å¯æŒç»­èƒ½æºã€‚' },
                { word: 'Biodiversity', chinese: 'ç”Ÿç‰©å¤šæ ·æ€§', pronunciation: '/ËŒbaÉªÉ™ÊŠdaÉªËˆvÉœËsÉ™ti/', example: 'Biodiversity is important for life. ç”Ÿç‰©å¤šæ ·æ€§å¯¹ç”Ÿå‘½å¾ˆé‡è¦ã€‚' },
                { word: 'Conservation', chinese: 'ä¿æŠ¤', pronunciation: '/ËŒkÉ’nsÉ™ËˆveÉªÊƒn/', example: 'Conservation saves wildlife. ä¿æŠ¤æ‹¯æ•‘é‡ç”ŸåŠ¨ç‰©ã€‚' },
                { word: 'Photosynthesis', chinese: 'å…‰åˆä½œç”¨', pronunciation: '/ËŒfÉ™ÊŠtÉ™ÊŠËˆsÉªnÎ¸É™sÉªs/', example: 'Plants use photosynthesis. æ¤ç‰©ä½¿ç”¨å…‰åˆä½œç”¨ã€‚' },
                { word: 'Metamorphosis', chinese: 'å˜æ€', pronunciation: '/ËŒmetÉ™ËˆmÉ”ËfÉ™sÉªs/', example: 'Butterflies go through metamorphosis. è´è¶ç»å†å˜æ€ã€‚' },
                { word: 'Archaeology', chinese: 'è€ƒå¤å­¦', pronunciation: '/ËŒÉ‘ËkiËˆÉ’lÉ™dÊ’i/', example: 'Archaeology studies ancient cultures. è€ƒå¤å­¦ç ”ç©¶å¤ä»£æ–‡åŒ–ã€‚' },
                { word: 'Philosophy', chinese: 'å“²å­¦', pronunciation: '/fÉ™ËˆlÉ’sÉ™fi/', example: 'Philosophy asks big questions. å“²å­¦æå‡ºé‡å¤§é—®é¢˜ã€‚' },
                { word: 'Psychology', chinese: 'å¿ƒç†å­¦', pronunciation: '/saÉªËˆkÉ’lÉ™dÊ’i/', example: 'Psychology studies the mind. å¿ƒç†å­¦ç ”ç©¶å¿ƒç†ã€‚' },
                { word: 'Anthropology', chinese: 'äººç±»å­¦', pronunciation: '/ËŒÃ¦nÎ¸rÉ™ËˆpÉ’lÉ™dÊ’i/', example: 'Anthropology studies human culture. äººç±»å­¦ç ”ç©¶äººç±»æ–‡åŒ–ã€‚' },
                { word: 'Economics', chinese: 'ç»æµå­¦', pronunciation: '/ËŒiËkÉ™ËˆnÉ’mÉªks/', example: 'Economics studies money and trade. ç»æµå­¦ç ”ç©¶è´§å¸å’Œè´¸æ˜“ã€‚' },
                { word: 'Entrepreneurship', chinese: 'åˆ›ä¸š', pronunciation: '/ËŒÉ’ntrÉ™prÉ™ËˆnÉœËÊƒÉªp/', example: 'Entrepreneurship creates new businesses. åˆ›ä¸šåˆ›é€ æ–°ä¼ä¸šã€‚' },
                { word: 'Communication', chinese: 'äº¤æµ', pronunciation: '/kÉ™ËŒmjuËnÉªËˆkeÉªÊƒn/', example: 'Communication is key to success. äº¤æµæ˜¯æˆåŠŸçš„å…³é”®ã€‚' },
                { word: 'Collaboration', chinese: 'åˆä½œ', pronunciation: '/kÉ™ËŒlÃ¦bÉ™ËˆreÉªÊƒn/', example: 'Teamwork requires collaboration. å›¢é˜Ÿåˆä½œéœ€è¦åä½œã€‚' },
                { word: 'Perspective', chinese: 'è§†è§’', pronunciation: '/pÉ™ËˆspektÉªv/', example: 'Everyone has a different perspective. æ¯ä¸ªäººéƒ½æœ‰ä¸åŒçš„è§†è§’ã€‚' },
                { word: 'Consciousness', chinese: 'æ„è¯†', pronunciation: '/ËˆkÉ’nÊƒÉ™snÉ™s/', example: 'Consciousness is still a mystery. æ„è¯†ä»ç„¶æ˜¯ä¸€ä¸ªè°œã€‚' },
                { word: 'Artificial', chinese: 'äººå·¥çš„', pronunciation: '/ËŒÉ‘ËtÉªËˆfÉªÊƒl/', example: 'Artificial intelligence is advancing. äººå·¥æ™ºèƒ½æ­£åœ¨è¿›æ­¥ã€‚' },
                { word: 'Extraordinary', chinese: 'éå‡¡çš„', pronunciation: '/ÉªkËˆstrÉ”Ëdnri/', example: 'She has extraordinary talent. å¥¹æœ‰éå‡¡çš„æ‰èƒ½ã€‚' }
            ],
            6: [
                { word: 'Philosophical', chinese: 'å“²å­¦çš„', pronunciation: '/ËŒfÉªlÉ™ËˆsÉ’fÉªkl/', example: 'This is a philosophical question. è¿™æ˜¯ä¸€ä¸ªå“²å­¦é—®é¢˜ã€‚' },
                { word: 'Revolutionary', chinese: 'é©å‘½æ€§çš„', pronunciation: '/ËŒrevÉ™ËˆluËÊƒÉ™nri/', example: 'This is a revolutionary idea. è¿™æ˜¯ä¸€ä¸ªé©å‘½æ€§çš„æƒ³æ³•ã€‚' },
                { word: 'Sophisticated', chinese: 'å¤æ‚çš„', pronunciation: '/sÉ™ËˆfÉªstÉªkeÉªtÉªd/', example: 'The technology is sophisticated. è¿™é¡¹æŠ€æœ¯å¾ˆå¤æ‚ã€‚' },
                { word: 'Controversial', chinese: 'æœ‰äº‰è®®çš„', pronunciation: '/ËŒkÉ’ntrÉ™ËˆvÉœËÊƒl/', example: 'The topic is controversial. è¿™ä¸ªè¯é¢˜æœ‰äº‰è®®ã€‚' },
                { word: 'Comprehensive', chinese: 'ç»¼åˆçš„', pronunciation: '/ËŒkÉ’mprÉªËˆhensÉªv/', example: 'This is a comprehensive study. è¿™æ˜¯ä¸€é¡¹ç»¼åˆç ”ç©¶ã€‚' },
                { word: 'Fundamental', chinese: 'åŸºæœ¬çš„', pronunciation: '/ËŒfÊŒndÉ™Ëˆmentl/', example: 'This is a fundamental principle. è¿™æ˜¯ä¸€ä¸ªåŸºæœ¬åŸåˆ™ã€‚' },
                { word: 'Significance', chinese: 'é‡è¦æ€§', pronunciation: '/sÉªÉ¡ËˆnÉªfÉªkÉ™ns/', example: 'The event has great significance. è¿™ä¸€äº‹ä»¶å…·æœ‰é‡å¤§æ„ä¹‰ã€‚' },
                { word: 'Consequently', chinese: 'å› æ­¤', pronunciation: '/ËˆkÉ’nsÉªkwÉ™ntli/', example: 'Consequently, we must act now. å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»ç°åœ¨è¡ŒåŠ¨ã€‚' },
                { word: 'Nevertheless', chinese: 'ç„¶è€Œ', pronunciation: '/ËŒnevÉ™Ã°É™Ëˆles/', example: 'Nevertheless, we tried again. ç„¶è€Œï¼Œæˆ‘ä»¬å†æ¬¡å°è¯•ã€‚' },
                { word: 'Furthermore', chinese: 'æ­¤å¤–', pronunciation: '/ËŒfÉœËÃ°É™ËˆmÉ”Ër/', example: 'Furthermore, we need more data. æ­¤å¤–ï¼Œæˆ‘ä»¬éœ€è¦æ›´å¤šæ•°æ®ã€‚' },
                { word: 'Simultaneously', chinese: 'åŒæ—¶åœ°', pronunciation: '/ËŒsÉªmlËˆteÉªniÉ™sli/', example: 'They arrived simultaneously. ä»–ä»¬åŒæ—¶åˆ°è¾¾ã€‚' },
                { word: 'Predominantly', chinese: 'ä¸»è¦åœ°', pronunciation: '/prÉªËˆdÉ’mÉªnÉ™ntli/', example: 'The area is predominantly rural. è¿™ä¸ªåœ°åŒºä¸»è¦æ˜¯å†œæ‘ã€‚' },
                { word: 'Approximately', chinese: 'å¤§çº¦', pronunciation: '/É™ËˆprÉ’ksÉªmÉ™tli/', example: 'It takes approximately one hour. å¤§çº¦éœ€è¦ä¸€ä¸ªå°æ—¶ã€‚' },
                { word: 'Characteristic', chinese: 'ç‰¹å¾', pronunciation: '/ËŒkÃ¦rÉ™ktÉ™ËˆrÉªstÉªk/', example: 'This is a key characteristic. è¿™æ˜¯ä¸€ä¸ªå…³é”®ç‰¹å¾ã€‚' },
                { word: 'Infrastructure', chinese: 'åŸºç¡€è®¾æ–½', pronunciation: '/ËˆÉªnfrÉ™strÊŒktÊƒÉ™r/', example: 'The city needs better infrastructure. è¿™åº§åŸå¸‚éœ€è¦æ›´å¥½çš„åŸºç¡€è®¾æ–½ã€‚' },
                { word: 'Interpretation', chinese: 'è§£é‡Š', pronunciation: '/ÉªnËŒtÉœËprÉªËˆteÉªÊƒn/', example: 'There are many interpretations. æœ‰å¾ˆå¤šè§£é‡Šã€‚' },
                { word: 'Responsibility', chinese: 'è´£ä»»', pronunciation: '/rÉªËŒspÉ’nsÉ™ËˆbÉªlÉ™ti/', example: 'Take responsibility for your actions. ä¸ºä½ çš„è¡Œä¸ºè´Ÿè´£ã€‚' },
                { word: 'Accomplishment', chinese: 'æˆå°±', pronunciation: '/É™ËˆkÊŒmplÉªÊƒmÉ™nt/', example: 'This is a great accomplishment. è¿™æ˜¯ä¸€é¡¹ä¼Ÿå¤§çš„æˆå°±ã€‚' },
                { word: 'Determination', chinese: 'å†³å¿ƒ', pronunciation: '/dÉªËŒtÉœËmÉªËˆneÉªÊƒn/', example: 'Success requires determination. æˆåŠŸéœ€è¦å†³å¿ƒã€‚' },
                { word: 'Perseverance', chinese: 'åšæŒ', pronunciation: '/ËŒpÉœËsÉªËˆvÉªÉ™rÉ™ns/', example: 'Perseverance leads to success. åšæŒå¯¼è‡´æˆåŠŸã€‚' }
            ]
        };

        // ============ æ¸¸æˆçŠ¶æ€ ============
        let gameState = {
            currentGrade: 1,
            maze: [],
            playerPos: { row: 0, col: 0 },
            endPos: { row: 14, col: 6 },
            words: [],
            collectedWords: [],
            missedWords: [],
            breakableWalls: [],
            breakCount: 0,
            wallsBroken: 0,
            timeLeft: 60,
            timer: null,
            isPaused: false,
            isGameOver: false,
            soundEnabled: true,
            isDragging: false,
            startTime: null
        };

        const ROWS = 15;
        const COLS = 7;
        const WORD_COUNT = 5;

        // ============ é¡µé¢åˆ‡æ¢ ============
        function switchScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        function goHome() {
            stopGame();
            switchScreen('homeScreen');
        }

        // ============ æ¸¸æˆè¯´æ˜ ============
        let wasPlaying = false;

        function showHelp() {
            // å¦‚æœæ­£åœ¨æ¸¸æˆä¸­ï¼Œæš‚åœæ¸¸æˆ
            if (document.getElementById('gameScreen').classList.contains('active') &&
                !gameState.isPaused && !gameState.isGameOver) {
                wasPlaying = true;
                clearInterval(gameState.timer);
            } else {
                wasPlaying = false;
            }
            document.getElementById('helpModal').classList.add('active');
        }

        function closeHelp() {
            document.getElementById('helpModal').classList.remove('active');
            // å¦‚æœä¹‹å‰åœ¨æ¸¸æˆä¸­ï¼Œæ¢å¤è®¡æ—¶
            if (wasPlaying && !gameState.isPaused && !gameState.isGameOver) {
                startTimer();
            }
        }

        // ============ æš‚åœåŠŸèƒ½ ============
        function togglePause() {
            if (gameState.isGameOver) return;

            gameState.isPaused = !gameState.isPaused;
            const pauseBtn = document.getElementById('pauseBtn');

            if (gameState.isPaused) {
                // æš‚åœæ¸¸æˆ - ç›´æ¥æš‚åœï¼Œä¸å¼¹çª—
                pauseBtn.textContent = 'â–¶ï¸';
                clearInterval(gameState.timer);
                // åœæ­¢TTS
                speechSynthesis.cancel();
            } else {
                // ç»§ç»­æ¸¸æˆ
                pauseBtn.textContent = 'â¸ï¸';
                startTimer();
            }
        }

        // æš‚åœèœå•ï¼ˆä»å¯¼èˆªæ è¿”å›æ—¶ä½¿ç”¨ï¼‰
        function showPauseMenu() {
            if (gameState.isGameOver) return;
            gameState.isPaused = true;
            clearInterval(gameState.timer);
            document.getElementById('pauseBtn').textContent = 'â–¶ï¸';
            document.getElementById('pauseModal').classList.add('active');
        }

        function closePauseMenu() {
            document.getElementById('pauseModal').classList.remove('active');
            gameState.isPaused = false;
            document.getElementById('pauseBtn').textContent = 'â¸ï¸';
            startTimer();
        }

        // ============ éŸ³æ•ˆæ§åˆ¶ ============
        function toggleSound() {
            gameState.soundEnabled = !gameState.soundEnabled;
            document.getElementById('volumeBtn').textContent = gameState.soundEnabled ? 'ğŸ”Š' : 'ğŸ”‡';
        }

        // ============ Toastæç¤º ============
        function showToast(message, duration = 2000) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');

            setTimeout(() => {
                toast.classList.remove('show');
            }, duration);
        }

        // ============ è¿·å®«ç”Ÿæˆç®—æ³• (æ”¹è¿›ç‰ˆ) ============
        function generateMaze() {
            // åˆå§‹åŒ–è¿·å®«ï¼Œå…¨éƒ¨æ˜¯å¢™
            const maze = [];
            for (let r = 0; r < ROWS; r++) {
                maze[r] = [];
                for (let c = 0; c < COLS; c++) {
                    maze[r][c] = { type: 'wall', isBreakable: false, hasWord: false, wordData: null };
                }
            }

            // ä½¿ç”¨æ”¹è¿›çš„DFSç”Ÿæˆè¿·å®«è·¯å¾„ï¼ˆæ­¥é•¿ä¸º1ï¼‰
            const visited = [];
            for (let r = 0; r < ROWS; r++) {
                visited[r] = [];
                for (let c = 0; c < COLS; c++) {
                    visited[r][c] = false;
                }
            }

            // ä»èµ·ç‚¹å¼€å§‹DFSï¼Œæ­¥é•¿ä¸º1
            function dfs(row, col) {
                visited[row][col] = true;
                maze[row][col].type = 'path';

                // éšæœºæ‰“ä¹±æ–¹å‘ï¼ˆæ­¥é•¿ä¸º1ï¼‰
                const directions = [
                    [-1, 0], [1, 0], [0, -1], [0, 1]
                ];
                shuffleArray(directions);

                for (const [dr, dc] of directions) {
                    const newRow = row + dr;
                    const newCol = col + dc;

                    if (newRow >= 0 && newRow < ROWS && newCol >= 0 && newCol < COLS && !visited[newRow][newCol]) {
                        // éšæœºå†³å®šæ˜¯å¦æŒ–é€šè¿™ä¸ªæ–¹å‘ï¼ˆæ§åˆ¶è¿·å®«å¯†åº¦ï¼‰
                        if (Math.random() > 0.3) {
                            dfs(newRow, newCol);
                        }
                    }
                }
            }

            // ä»èµ·ç‚¹å¼€å§‹
            dfs(0, 0);

            // ç¡®ä¿ç»ˆç‚¹å¯è¾¾ - ä½¿ç”¨BFSæ£€æŸ¥å¹¶ä¿®å¤
            ensurePathToEnd(maze);

            // æ·»åŠ æ›´å¤šè·¯å¾„è®©è¿·å®«æ›´æœ‰è¶£
            addExtraPaths(maze);

            // æ ‡è®°èµ·ç‚¹å’Œç»ˆç‚¹
            maze[0][0].type = 'start';
            maze[ROWS - 1][COLS - 1].type = 'end';

            // æ·»åŠ ä¸€äº›å¯ç ´åçš„å¢™
            addBreakableWalls(maze);

            return maze;
        }

        function ensurePathToEnd(maze) {
            // ä½¿ç”¨BFSæ£€æŸ¥ä»èµ·ç‚¹åˆ°ç»ˆç‚¹æ˜¯å¦å¯è¾¾
            const visited = [];
            for (let r = 0; r < ROWS; r++) {
                visited[r] = [];
                for (let c = 0; c < COLS; c++) {
                    visited[r][c] = false;
                }
            }

            const queue = [[0, 0]];
            visited[0][0] = true;
            const parent = {};
            parent['0,0'] = null;

            while (queue.length > 0) {
                const [row, col] = queue.shift();

                if (row === ROWS - 1 && col === COLS - 1) {
                    // æ‰¾åˆ°è·¯å¾„
                    return;
                }

                const directions = [[-1, 0], [1, 0], [0, -1], [0, 1]];
                for (const [dr, dc] of directions) {
                    const newRow = row + dr;
                    const newCol = col + dc;

                    if (newRow >= 0 && newRow < ROWS && newCol >= 0 && newCol < COLS &&
                        !visited[newRow][newCol] && maze[newRow][newCol].type !== 'wall') {
                        visited[newRow][newCol] = true;
                        parent[`${newRow},${newCol}`] = [row, col];
                        queue.push([newRow, newCol]);
                    }
                }
            }

            // å¦‚æœæ²¡æœ‰è·¯å¾„ï¼Œå¼ºåˆ¶æ‰“é€šä¸€æ¡
            let row = ROWS - 1;
            let col = COLS - 1;

            while (row > 0 || col > 0) {
                maze[row][col].type = 'path';

                // éšæœºé€‰æ‹©å‘ä¸Šæˆ–å‘å·¦
                if (row > 0 && col > 0) {
                    if (Math.random() > 0.5) {
                        row--;
                    } else {
                        col--;
                    }
                } else if (row > 0) {
                    row--;
                } else {
                    col--;
                }
            }
        }

        function addExtraPaths(maze) {
            // éšæœºæ·»åŠ ä¸€äº›é¢å¤–çš„è·¯å¾„ï¼Œè®©è¿·å®«æ›´æœ‰è¶£
            for (let r = 1; r < ROWS - 1; r++) {
                for (let c = 1; c < COLS - 1; c++) {
                    if (maze[r][c].type === 'wall') {
                        // æ£€æŸ¥å‘¨å›´æ˜¯å¦æœ‰è·¯å¾„
                        const neighbors = [
                            [r-1, c], [r+1, c], [r, c-1], [r, c+1]
                        ];
                        let pathCount = 0;
                        for (const [nr, nc] of neighbors) {
                            if (nr >= 0 && nr < ROWS && nc >= 0 && nc < COLS &&
                                maze[nr][nc].type !== 'wall') {
                                pathCount++;
                            }
                        }

                        // å¦‚æœå‘¨å›´æœ‰2ä¸ªä»¥ä¸Šçš„è·¯å¾„ï¼Œæœ‰ä¸€å®šæ¦‚ç‡æ‰“é€š
                        if (pathCount >= 2 && Math.random() > 0.7) {
                            maze[r][c].type = 'path';
                        }
                    }
                }
            }
        }

        function addBreakableWalls(maze) {
            gameState.breakableWalls = [];
            let breakableCount = 0;
            const maxBreakable = 8;

            // å¯»æ‰¾å¯ä»¥è®¾ç½®ä¸ºå¯ç ´åçš„å¢™
            for (let r = 1; r < ROWS - 1; r++) {
                for (let c = 1; c < COLS - 1; c++) {
                    if (maze[r][c].type === 'wall' && breakableCount < maxBreakable) {
                        // æ£€æŸ¥è¿™ä¸ªå¢™ä¸¤è¾¹æ˜¯å¦æœ‰è·¯å¾„
                        const hasPathNearby =
                            (r > 0 && maze[r-1][c].type === 'path') ||
                            (r < ROWS-1 && maze[r+1][c].type === 'path') ||
                            (c > 0 && maze[r][c-1].type === 'path') ||
                            (c < COLS-1 && maze[r][c+1].type === 'path');

                        if (hasPathNearby && Math.random() > 0.6) {
                            maze[r][c].isBreakable = true;
                            gameState.breakableWalls.push({ row: r, col: c });
                            breakableCount++;
                        }
                    }
                }
            }
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // ============ æ”¾ç½®å•è¯ ============
        function placeWords(maze) {
            const words = wordDatabase[gameState.currentGrade];
            const selectedWords = [];
            const usedIndices = new Set();

            // éšæœºé€‰æ‹©5ä¸ªå•è¯
            while (selectedWords.length < WORD_COUNT && usedIndices.size < words.length) {
                const idx = Math.floor(Math.random() * words.length);
                if (!usedIndices.has(idx)) {
                    usedIndices.add(idx);
                    selectedWords.push({ ...words[idx] });
                }
            }

            // æ‰¾åˆ°æ‰€æœ‰å¯ä»¥æ”¾ç½®å•è¯çš„è·¯å¾„æ ¼å­ï¼ˆæ’é™¤èµ·ç‚¹å’Œç»ˆç‚¹ï¼‰
            const pathCells = [];
            for (let r = 0; r < ROWS; r++) {
                for (let c = 0; c < COLS; c++) {
                    if (maze[r][c].type === 'path') {
                        // ä¸åœ¨èµ·ç‚¹é™„è¿‘
                        if (!(r < 2 && c < 2)) {
                            // ä¸åœ¨ç»ˆç‚¹é™„è¿‘
                            if (!(r > ROWS - 3 && c > COLS - 3)) {
                                pathCells.push({ row: r, col: c });
                            }
                        }
                    }
                }
            }

            // éšæœºé€‰æ‹©ä½ç½®æ”¾ç½®å•è¯
            shuffleArray(pathCells);

            gameState.words = [];
            for (let i = 0; i < Math.min(WORD_COUNT, pathCells.length, selectedWords.length); i++) {
                const cell = pathCells[i];
                maze[cell.row][cell.col].hasWord = true;
                maze[cell.row][cell.col].wordData = selectedWords[i];
                gameState.words.push({
                    row: cell.row,
                    col: cell.col,
                    data: selectedWords[i],
                    collected: false
                });
            }
        }

        // ============ æ¸²æŸ“è¿·å®« ============
        function renderMaze() {
            const grid = document.getElementById('mazeGrid');
            grid.innerHTML = '';

            // è®¡ç®—æ ¼å­å¤§å°
            const containerWidth = Math.min(370, window.innerWidth - 30);
            const cellSize = Math.floor((containerWidth - 10) / COLS);

            grid.style.gridTemplateColumns = `repeat(${COLS}, ${cellSize}px)`;
            grid.style.gridTemplateRows = `repeat(${ROWS}, ${cellSize}px)`;

            for (let r = 0; r < ROWS; r++) {
                for (let c = 0; c < COLS; c++) {
                    const cell = document.createElement('div');
                    cell.className = 'maze-cell';
                    cell.dataset.row = r;
                    cell.dataset.col = c;

                    const cellData = gameState.maze[r][c];

                    if (cellData.type === 'start') {
                        cell.classList.add('start');
                    } else if (cellData.type === 'end') {
                        cell.classList.add('end');
                    } else if (cellData.type === 'wall') {
                        cell.classList.add('wall');
                        if (cellData.isBreakable) {
                            cell.classList.add('breakable');
                            cell.onclick = () => tryBreakWall(r, c);
                        }
                    } else {
                        cell.classList.add('path');
                    }

                    // æ·»åŠ å•è¯
                    if (cellData.hasWord && !gameState.words.find(w => w.row === r && w.col === c)?.collected) {
                        const wordItem = document.createElement('div');
                        wordItem.className = 'word-item';
                        wordItem.textContent = cellData.wordData.word;
                        wordItem.id = `word-${r}-${c}`;
                        cell.appendChild(wordItem);
                    }

                    grid.appendChild(cell);
                }
            }

            // æ·»åŠ ç©å®¶
            addPlayer();
        }

        // å­˜å‚¨äº‹ä»¶å¤„ç†å™¨å¼•ç”¨ï¼Œé¿å…é‡å¤ç»‘å®š
        let dragHandlers = null;

        function addPlayer() {
            const grid = document.getElementById('mazeGrid');
            let player = document.getElementById('player');

            // ç§»é™¤æ—§çš„äº‹ä»¶ç›‘å¬å™¨
            if (dragHandlers) {
                document.removeEventListener('touchmove', dragHandlers.handleMove);
                document.removeEventListener('touchend', dragHandlers.handleEnd);
                document.removeEventListener('mousemove', dragHandlers.handleMove);
                document.removeEventListener('mouseup', dragHandlers.handleEnd);
            }

            if (!player) {
                player = document.createElement('div');
                player.id = 'player';
                player.className = 'player';
                player.textContent = 'ğŸ‘¦';
                grid.appendChild(player);
            }

            updatePlayerPosition();
            setupDragControls(player);
        }

        function updatePlayerPosition() {
            const player = document.getElementById('player');
            const grid = document.getElementById('mazeGrid');

            if (!player || !grid) return;

            const cells = grid.querySelectorAll('.maze-cell');
            const cellSize = cells[0]?.offsetWidth || 40;

            const x = gameState.playerPos.col * (cellSize + 2) + cellSize / 2 - 12;
            const y = gameState.playerPos.row * (cellSize + 2) + cellSize / 2 - 12;

            player.style.left = `${x}px`;
            player.style.top = `${y}px`;
        }

        // ============ æ‹–æ‹½æ§åˆ¶ ============
        function setupDragControls(player) {
            let startX, startY;
            let lastValidPos = { ...gameState.playerPos };

            const handleStart = (e) => {
                if (gameState.isPaused || gameState.isGameOver) return;

                e.preventDefault();
                gameState.isDragging = true;

                const touch = e.touches ? e.touches[0] : e;
                startX = touch.clientX;
                startY = touch.clientY;
                lastValidPos = { ...gameState.playerPos };

                player.style.animation = 'none';
                player.style.transform = 'scale(1.2)';
            };

            const handleMove = (e) => {
                if (!gameState.isDragging || gameState.isPaused || gameState.isGameOver) return;

                e.preventDefault();
                const touch = e.touches ? e.touches[0] : e;

                const dx = touch.clientX - startX;
                const dy = touch.clientY - startY;

                const grid = document.getElementById('mazeGrid');
                const cells = grid.querySelectorAll('.maze-cell');
                const cellSize = cells[0]?.offsetWidth || 40;
                const threshold = cellSize / 2;

                let newRow = lastValidPos.row;
                let newCol = lastValidPos.col;

                // åˆ¤æ–­ç§»åŠ¨æ–¹å‘
                if (Math.abs(dx) > Math.abs(dy)) {
                    if (dx > threshold) newCol = lastValidPos.col + 1;
                    else if (dx < -threshold) newCol = lastValidPos.col - 1;
                } else {
                    if (dy > threshold) newRow = lastValidPos.row + 1;
                    else if (dy < -threshold) newRow = lastValidPos.row - 1;
                }

                // æ£€æŸ¥æ˜¯å¦å¯ä»¥ç§»åŠ¨ï¼ˆåªèƒ½ç§»åŠ¨ä¸€æ ¼ï¼‰
                if ((newRow !== lastValidPos.row || newCol !== lastValidPos.col) && canMoveTo(newRow, newCol)) {
                    gameState.playerPos = { row: newRow, col: newCol };
                    updatePlayerPosition();

                    // æ£€æŸ¥æ˜¯å¦æ”¶é›†åˆ°å•è¯
                    checkWordCollection();

                    // æ£€æŸ¥æ˜¯å¦åˆ°è¾¾ç»ˆç‚¹
                    checkWinCondition();

                    // é‡ç½®æ‹–æ‹½èµ·ç‚¹
                    startX = touch.clientX;
                    startY = touch.clientY;
                    lastValidPos = { ...gameState.playerPos };
                }
            };

            const handleEnd = () => {
                gameState.isDragging = false;
                player.style.transform = 'scale(1)';
                player.style.animation = 'playerBounce 1s ease-in-out infinite';
            };

            // ä¿å­˜äº‹ä»¶å¤„ç†å™¨å¼•ç”¨
            dragHandlers = { handleMove, handleEnd };

            // è§¦æ‘¸äº‹ä»¶
            player.addEventListener('touchstart', handleStart, { passive: false });
            document.addEventListener('touchmove', handleMove, { passive: false });
            document.addEventListener('touchend', handleEnd);

            // é¼ æ ‡äº‹ä»¶
            player.addEventListener('mousedown', handleStart);
            document.addEventListener('mousemove', handleMove);
            document.addEventListener('mouseup', handleEnd);
        }

        function canMoveTo(row, col) {
            if (row < 0 || row >= ROWS || col < 0 || col >= COLS) return false;

            const cell = gameState.maze[row][col];
            // åªæœ‰éå¢™å£æ‰èƒ½ç§»åŠ¨ï¼ˆpath, start, endï¼‰
            return cell.type !== 'wall';
        }

        // ============ å•è¯æ”¶é›† ============
        function checkWordCollection() {
            const { row, col } = gameState.playerPos;

            const wordIdx = gameState.words.findIndex(w =>
                w.row === row && w.col === col && !w.collected
            );

            if (wordIdx !== -1) {
                const word = gameState.words[wordIdx];
                word.collected = true;
                gameState.collectedWords.push(word.data);
                gameState.breakCount++;

                // åŠ¨ç”»æ•ˆæœ
                const wordElement = document.getElementById(`word-${row}-${col}`);
                if (wordElement) {
                    wordElement.classList.add('collecting');
                    setTimeout(() => wordElement.remove(), 300);
                }

                // æ›´æ–°UI
                updateGameInfo();

                // æ˜¾ç¤ºå•è¯å¼¹çª—
                showWordPopup(word.data);

                // TTSæœ—è¯»
                if (gameState.soundEnabled) {
                    speakWord(word.data);
                }
            }
        }

        function showWordPopup(wordData) {
            // æš‚åœæ¸¸æˆ
            clearInterval(gameState.timer);

            document.getElementById('popupWord').textContent = wordData.word;
            document.getElementById('popupChinese').textContent = wordData.chinese;
            document.getElementById('popupExample').textContent = wordData.example;

            document.getElementById('wordOverlay').classList.add('active');
            document.getElementById('wordPopup').classList.add('active');
        }

        function closeWordPopup() {
            document.getElementById('wordOverlay').classList.remove('active');
            document.getElementById('wordPopup').classList.remove('active');

            // ç»§ç»­æ¸¸æˆ
            if (!gameState.isPaused && !gameState.isGameOver) {
                startTimer();
            }
        }

        // ============ ç ´å¢™åŠŸèƒ½ ============
        function tryBreakWall(row, col) {
            if (gameState.breakCount <= 0) {
                // æ²¡æœ‰å¯ç”¨çš„ç ´å¢™æ¬¡æ•°
                showToast('ğŸ’¡ è¯·å…ˆæ”¶é›†å•è¯è·å¾—ç ´å¢™èƒ½åŠ›ï¼');
                return;
            }

            const cell = gameState.maze[row][col];
            if (!cell.isBreakable) return;

            // æ£€æŸ¥ç©å®¶æ˜¯å¦åœ¨å¢™å£æ—è¾¹
            const playerPos = gameState.playerPos;
            const isAdjacent =
                (Math.abs(playerPos.row - row) === 1 && playerPos.col === col) ||
                (Math.abs(playerPos.col - col) === 1 && playerPos.row === row);

            if (!isAdjacent) {
                showToast('ğŸ‘† è¯·ç§»åŠ¨åˆ°å¢™å£æ—è¾¹å†ç ´å¢™ï¼');
                return;
            }

            // ç ´å¢™
            cell.type = 'path';
            cell.isBreakable = false;
            gameState.breakCount--;
            gameState.wallsBroken++;

            // åŠ¨ç”»æ•ˆæœ
            const cellElement = document.querySelector(`.maze-cell[data-row="${row}"][data-col="${col}"]`);
            if (cellElement) {
                cellElement.classList.add('breaking');
                setTimeout(() => {
                    cellElement.classList.remove('wall', 'breakable', 'breaking');
                    cellElement.classList.add('path');
                    cellElement.onclick = null;
                }, 500);
            }

            updateGameInfo();
        }

        // ============ TTSæœ—è¯» ============
        function speakWord(wordData) {
            if (!gameState.soundEnabled) return;

            // å–æ¶ˆä¹‹å‰çš„æœ—è¯»
            speechSynthesis.cancel();

            // æœ—è¯»è‹±æ–‡å•è¯
            const wordUtterance = new SpeechSynthesisUtterance(wordData.word);
            wordUtterance.lang = 'en-US';
            wordUtterance.rate = 0.9;

            wordUtterance.onend = () => {
                // æœ—è¯»ä¸­æ–‡
                setTimeout(() => {
                    const chineseUtterance = new SpeechSynthesisUtterance(wordData.chinese);
                    chineseUtterance.lang = 'zh-CN';
                    chineseUtterance.rate = 0.9;
                    speechSynthesis.speak(chineseUtterance);
                }, 300);
            };

            speechSynthesis.speak(wordUtterance);
        }

        function speakWordOnly(word) {
            if (!gameState.soundEnabled) return;

            speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(word);
            utterance.lang = 'en-US';
            utterance.rate = 0.9;
            speechSynthesis.speak(utterance);
        }

        // ============ æ¸¸æˆé€»è¾‘ ============
        function updateGameInfo() {
            document.getElementById('wordCount').textContent =
                `${gameState.collectedWords.length}/${WORD_COUNT}`;
            document.getElementById('breakCount').textContent = gameState.breakCount;
        }

        function startTimer() {
            // å…ˆæ¸…é™¤æ—§è®¡æ—¶å™¨ï¼Œé˜²æ­¢å¤šä¸ªè®¡æ—¶å™¨åŒæ—¶è¿è¡Œ
            if (gameState.timer) {
                clearInterval(gameState.timer);
            }

            gameState.timer = setInterval(() => {
                if (gameState.isPaused || gameState.isGameOver) return;

                gameState.timeLeft--;
                updateTimerDisplay();

                if (gameState.timeLeft <= 0) {
                    gameOver(false);
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(gameState.timeLeft / 60);
            const seconds = gameState.timeLeft % 60;
            const display = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('timeDisplay').textContent = display;

            const timerElement = document.getElementById('timerDisplay');
            if (gameState.timeLeft <= 10) {
                timerElement.classList.add('warning');
            } else {
                timerElement.classList.remove('warning');
            }
        }

        function checkWinCondition() {
            const { row, col } = gameState.playerPos;
            if (row === ROWS - 1 && col === COLS - 1) {
                gameOver(true);
            }
        }

        function gameOver(isVictory) {
            gameState.isGameOver = true;
            clearInterval(gameState.timer);

            // è®¡ç®—é”™è¿‡çš„å•è¯
            gameState.missedWords = gameState.words
                .filter(w => !w.collected)
                .map(w => w.data);

            // è®¡ç®—å¾—åˆ†
            const timeBonus = gameState.timeLeft * 2;
            const wordBonus = gameState.collectedWords.length * 20;
            const wallBonus = gameState.wallsBroken * 10;
            const victoryBonus = isVictory ? 50 : 0;
            const totalScore = timeBonus + wordBonus + wallBonus + victoryBonus;

            // æ›´æ–°ç»“æŸé¡µé¢
            const gameOverScreen = document.getElementById('gameOverScreen');
            gameOverScreen.classList.remove('victory', 'defeat');
            gameOverScreen.classList.add(isVictory ? 'victory' : 'defeat');

            document.getElementById('resultIcons').textContent = isVictory ? 'ğŸ‰ğŸ†ğŸ‰' : 'ğŸ˜¢ğŸ’”ğŸ˜¢';
            document.getElementById('resultTitle').textContent = isVictory ? 'æ­å–œé€šå…³ï¼' : 'æ—¶é—´åˆ°ï¼';
            document.getElementById('resultSubtitle').textContent = isVictory
                ? 'ä½ æˆåŠŸèµ°å‡ºäº†è¿·å®«'
                : 'å†æ¥å†å‰ï¼Œä¸‹æ¬¡ä¸€å®šèƒ½æˆåŠŸï¼';

            const timeUsed = 60 - gameState.timeLeft;
            document.getElementById('statTime').textContent =
                `${Math.floor(timeUsed / 60).toString().padStart(2, '0')}:${(timeUsed % 60).toString().padStart(2, '0')}`;
            document.getElementById('statWords').textContent = gameState.collectedWords.length;
            document.getElementById('statWalls').textContent = gameState.wallsBroken;
            document.getElementById('statScore').textContent = totalScore;

            // æ¸²æŸ“å•è¯å›é¡¾
            renderWordReview();

            switchScreen('gameOverScreen');
        }

        function renderWordReview() {
            // æ”¶é›†çš„å•è¯
            const correctList = document.getElementById('correctWordsList');
            correctList.innerHTML = '';
            document.getElementById('correctTitle').textContent =
                `âœ… æ”¶é›†çš„å•è¯ (${gameState.collectedWords.length}ä¸ª)`;

            gameState.collectedWords.forEach(word => {
                const item = document.createElement('div');
                item.className = 'review-word-item correct';
                item.innerHTML = `
                    <div>
                        <div class="word-en">${word.word}</div>
                        <div class="word-cn">${word.chinese}</div>
                    </div>
                    <button class="word-speak-btn" onclick="speakWordOnly('${word.word}')">ğŸ”Š</button>
                `;
                correctList.appendChild(item);
            });

            // é”™è¿‡çš„å•è¯
            const missedList = document.getElementById('missedWordsList');
            missedList.innerHTML = '';
            document.getElementById('missedTitle').textContent =
                `âŒ é”™è¿‡çš„å•è¯ (${gameState.missedWords.length}ä¸ª)`;

            if (gameState.missedWords.length === 0) {
                missedList.innerHTML = '<div style="text-align: center; color: #999; padding: 10px;">ğŸ‰ å…¨éƒ¨æ”¶é›†ï¼å¤ªæ£’äº†ï¼</div>';
            } else {
                gameState.missedWords.forEach(word => {
                    const item = document.createElement('div');
                    item.className = 'review-word-item wrong';
                    item.innerHTML = `
                        <div>
                            <div class="word-en">${word.word}</div>
                            <div class="word-cn">${word.chinese}</div>
                        </div>
                        <button class="word-speak-btn" onclick="speakWordOnly('${word.word}')">ğŸ”Š</button>
                    `;
                    missedList.appendChild(item);
                });
            }
        }

        // ============ æ¸¸æˆæ§åˆ¶ ============
        function startGame() {
            // é‡ç½®æ¸¸æˆçŠ¶æ€
            gameState = {
                currentGrade: parseInt(document.getElementById('gradeSelect').value),
                maze: [],
                playerPos: { row: 0, col: 0 },
                endPos: { row: ROWS - 1, col: COLS - 1 },
                words: [],
                collectedWords: [],
                missedWords: [],
                breakableWalls: [],
                breakCount: 0,
                wallsBroken: 0,
                timeLeft: 60,
                timer: null,
                isPaused: false,
                isGameOver: false,
                soundEnabled: gameState.soundEnabled,
                isDragging: false,
                startTime: Date.now()
            };

            // ç”Ÿæˆè¿·å®«
            gameState.maze = generateMaze();

            // æ”¾ç½®å•è¯
            placeWords(gameState.maze);

            // æ¸²æŸ“è¿·å®«
            renderMaze();

            // æ›´æ–°UI
            updateGameInfo();
            updateTimerDisplay();

            // é‡ç½®æš‚åœæŒ‰é’®
            document.getElementById('pauseBtn').textContent = 'â¸ï¸';

            // åˆ‡æ¢åˆ°æ¸¸æˆé¡µé¢
            switchScreen('gameScreen');

            // å¼€å§‹è®¡æ—¶
            startTimer();
        }

        function restartGame() {
            stopGame();
            document.getElementById('pauseModal').classList.remove('active');
            startGame();
        }

        function stopGame() {
            clearInterval(gameState.timer);
            gameState.timer = null;
            gameState.isGameOver = true;
            speechSynthesis.cancel();
        }

        // ============ çª—å£å¤§å°è°ƒæ•´ ============
        window.addEventListener('resize', () => {
            if (document.getElementById('gameScreen').classList.contains('active')) {
                renderMaze();
            }
        });

        // é˜»æ­¢é¡µé¢æ»šåŠ¨
        document.addEventListener('touchmove', (e) => {
            if (document.getElementById('gameScreen').classList.contains('active')) {
                e.preventDefault();
            }
        }, { passive: false });

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            // é¢„åŠ è½½è¯­éŸ³
            if ('speechSynthesis' in window) {
                speechSynthesis.getVoices();
            }
        });
    </script>
</body>
</html>
